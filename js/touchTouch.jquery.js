(function(){var b=$('<div id="galleryOverlay">'),d=$('<div id="gallerySlider">'),e=$('<a id="prevArrow"></a>'),c=$('<a id="nextArrow"></a>'),a=false;$.fn.touchTouch=function(){var n=$([]),l=0,p=this,m=p;b.hide().appendTo("body");d.appendTo(b);m.each(function(){n=n.add($('<div class="placeholder">'))});d.append(n).on("click",function(r){if(!$(r.target).is("img")){g()}});$("body").on("touchstart","#gallerySlider img",function(s){var t=s.originalEvent,r=t.changedTouches[0].pageX;d.on("touchmove",function(u){u.preventDefault();t=u.originalEvent.touches[0]||u.originalEvent.changedTouches[0];if(t.pageX-r>10){d.off("touchmove");f()}else{if(t.pageX-r<-10){d.off("touchmove");i()}}});return false}).on("touchend",function(){d.off("touchmove")});m.on("click",function(v){v.preventDefault();var u=$(this),s,r,t=u.parent().closest("[data-gallery]");if(u.attr("data-gallery")){s=u.attr("data-gallery");r="item"}else{if(t.length){s=t.attr("data-gallery");r="ancestor"}}if(s&&r=="item"){m=$("[data-gallery="+s+"]")}else{if(s&&r=="ancestor"){m=m.filter(function(){return $(this).parent().closest("[data-gallery]").length})}}l=m.index(this);j(l);q(l);o(l+1);o(l-1)});if(!("ontouchstart" in window)){b.append(e).append(c);e.click(function(r){r.preventDefault();f()});c.click(function(r){r.preventDefault();i()})}$(window).bind("keydown",function(r){if(r.keyCode==37){f()}else{if(r.keyCode==39){i()}}});function j(r){if(a){return false}b.show();setTimeout(function(){b.addClass("visible")},100);k(r);a=true}function g(){if(!a){return false}b.hide().removeClass("visible");a=false;$(".placeholder").empty();m=p}function k(r){d.css("left",(-r*100)+"%")}function o(r){setTimeout(function(){q(r)},1000)}function q(r){if(r<0||r>=m.length){return false}h(m.eq(r).attr("href"),function(){n.eq(r).html(this)})}function h(s,t){var r=$("<img>").on("load",function(){t.call(r)});r.attr("src",s)}function i(){if(l+1<m.length){l++;k(l);o(l+1)}else{d.addClass("rightSpring");setTimeout(function(){d.removeClass("rightSpring")},500)}}function f(){if(l>0){l--;k(l);o(l-1)}else{d.addClass("leftSpring");setTimeout(function(){d.removeClass("leftSpring")},500)}}}})(jQuery);
